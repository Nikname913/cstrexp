(()=>{function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function n(e,t,o){return t&&a(e.prototype,t),o&&a(e,o),e}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,a=c(e);if(t){var n=c(this).constructor;o=Reflect.construct(a,arguments,n)}else o=a.apply(this,arguments);return p(this,o)}}function p(t,o){return!o||"object"!==e(o)&&"function"!=typeof o?s(t):o}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d="#D1C4E9",g={boxSizing:"border-box",display:"block",position:"absolute",width:"400px",height:"100%",top:"0",left:"0",backgroundColor:d,boxShadow:"0px 0px 5px grey",overflow:"hidden",borderRadius:"0px"},h={boxSizing:"border-box",display:"block",position:"absolute",width:"400px",height:"100%",top:"0",left:"0",marginLeft:"420px",backgroundColor:d,boxShadow:"0px 0px 5px grey",overflow:"hidden",borderRadius:"0px"},u={boxSizing:"border-box",display:"block",position:"absolute",width:"400px",height:"100%",top:"0",left:"0",marginLeft:"840px",backgroundColor:d,boxShadow:"0px 0px 5px grey",overflow:"hidden",borderRadius:"0px"},x={display:"block",position:"relative",width:"320px",height:"auto",minHeight:"100px",borderRadius:"10px",border:"1px solid white",marginTop:"100px",marginLeft:"38px",boxSizing:"border-box",padding:"14px"},m={display:"block",position:"relative",width:"100%",height:"40px",outline:"none",border:"1px solid grey",borderRadius:"5px",marginBottom:"10px",fontSize:"13px",paddingLeft:"12px"},b={boxSizing:"border-box",display:"block",position:"absolute",width:"100%",height:"60px",top:"0",left:"0",borderBottom:"2px solid white",lineHeight:"60px",paddingLeft:"58px"},f={display:"block",position:"absolute",width:"38px",height:"38px",borderRadius:"50%",top:"50%",marginTop:"-19px",left:"0",marginLeft:"10px",backgroundImage:"url(img/logo.png)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepaet:"no-repeat"},y={boxSizing:"border-box",display:"block",position:"absolute",width:"100%",height:"60px",top:"0",left:"0",borderBottom:"2px solid white",lineHeight:"60px",paddingLeft:"14px",fontSize:"13px",fontStyle:"italic"},S={boxSizing:"border-box",display:"block",position:"absolute",width:"30px",height:"30px",borderRadius:"50%",border:"1px solid white",top:"50%",marginTop:"-16px",left:"100%",marginLeft:"-58px"},w={boxSizing:"border-box",display:"block",position:"absolute",width:"30px",height:"30px",borderRadius:"50px",border:"1px solid white",top:"50%",marginTop:"-16px",left:"100%",marginLeft:"-102px"},R={boxSizing:"border-box",display:"block",position:"relative",width:"100%",height:"auto",minHeight:"300px",borderBottom:"2px solid white",marginTop:"80px",paddingBottom:"20px"},k={boxSizing:"border-box",display:"block",position:"relative",width:"110%",height:"500px",borderBottom:"2px solid white",marginTop:"80px",paddingBottom:"20px",overflowY:"scroll",overflowX:"hidden"},E={display:"block",position:"relative",width:"362px",height:"auto",minHeight:"100px",backgroundColor:"white",marginLeft:"18px",borderRadius:"5px",padding:"12px",paddingLeft:"16px",paddingRight:"20px",lineHeight:"20px",fontSize:"11px",boxSizing:"border-box",overflow:"hidden"},v={display:"block",position:"relative",width:"100%",height:"auto",fontSize:"12px"},C={display:"block",position:"absolute",width:"100%",height:"100vh",backgroundColor:"rgba(105,105,105,0.5)",top:"0",left:"0",zIndex:"10"},L={display:"block",position:"absolute",width:"240px",height:"auto",minHeight:"40px",borderRadius:"5px",backgroundColor:"white",color:"grey",left:"50%",marginLeft:"-120px",top:"200px",boxSizing:"border-box",padding:"18px",paddingTop:"16px",paddingBottom:"17px",paddingLeft:"20px",paddingRight:"24px",lineHeight:"18px",fontSize:"13px"},I={display:"block",position:"relative",width:"100%",height:"auto",margin:"0 auto",minHeight:"40px",paddingLeft:"14px",paddingRight:"16px",paddingTop:"6px",paddingBottom:"5px",boxSizing:"border-box",lineHeight:"20px",backgroundColor:"#E0E0E0"},N={display:"block",position:"relative",width:"100%",height:"40px",fontSize:"13px",backgroundColor:"transparent",border:"none",outline:"none",borderTop:"2px solid white",textAlign:"center",padding:"0",paddingTop:"2px",marginTop:"20px"},T={display:"block",position:"relative",width:"80%",height:"40px",fontSize:"13px",backgroundColor:"transparent",border:"none",outline:"none",borderTop:"2px solid white",textAlign:"center",padding:"0",paddingTop:"2px",marginLeft:"10%"},B={display:"block",position:"relative",width:"220px",height:"40px",borderRadius:"5px",marginTop:"5px",marginLeft:"auto",marginRight:"auto",marginBottom:"14px",textAlign:"center",lineHeight:"40px",cursor:"pointer",fontSize:"11px",color:"white",backgroundColor:"#9E9E9E",boxShadow:"0px 0px 6px 1px grey"},z={display:"block",position:"relative",width:"220px",height:"40px",borderRadius:"5px",marginTop:"5px",marginLeft:"auto",marginRight:"auto",marginBottom:"14px",textAlign:"center",lineHeight:"40px",cursor:"pointer",fontSize:"11px",color:"white",backgroundColor:"#9575CD",boxShadow:"0px 0px 6px 1px grey"},H={display:"block",position:"absolute",width:"40px",height:"40px",borderRadius:"5px",border:"2px solid grey",left:"100%",marginLeft:"-60px",top:"100%",marginTop:"20px",textAlign:"center",fontSize:"16px",lineHeight:"42px",cursor:"pointer"},U={display:"block",position:"absolute",width:"10px",height:"10px",backgroundColor:"red",borderRadius:"50%",top:"0",marginTop:"-5px",left:"100%",marginLeft:"-5px"},D={display:"block",position:"absolute",width:"300px",height:"auto",lineHeight:"18px",fontSize:"13px",color:"grey",textAlign:"center",marginLeft:"50px"},P={display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",height:"60px",width:"300px",border:"1px solid white",borderRadius:"10px",marginLeft:"auto",marginRight:"auto",marginTop:"14px",paddingLeft:"12px",paddingRight:"12px",boxSizing:"border-box"},O={display:"block",position:"relative",width:"129px",height:"36px",backgroundColor:"#4CAF50",borderRadius:"5px",lineHeight:"37px",fontSize:"11px",textAlign:"center",cursor:"pointer",color:"white",boxShadow:"0px 0px 6px 1px grey"},G={display:"block",position:"relative",width:"129px",height:"36px",backgroundColor:"#9E9E9E",borderRadius:"5px",lineHeight:"37px",fontSize:"11px",textAlign:"center",cursor:"pointer",color:"white",boxShadow:"0px 0px 6px 1px grey"},M={display:"block",position:"relative",width:"159px",height:"36px",backgroundColor:"#4CAF50",color:"white",boxShadow:"0px 0px 6px 1px grey",borderRadius:"5px",lineHeight:"37px",fontSize:"11px",textAlign:"center",cursor:"pointer",marginLeft:"18px",marginTop:"15px"},A={display:"block",position:"relative",width:"169px",height:"36px",backgroundColor:"#4CAF50",color:"white",boxShadow:"0px 0px 6px 1px grey",borderRadius:"5px",lineHeight:"37px",fontSize:"11px",textAlign:"center",cursor:"pointer",marginTop:"20px"},F={display:"block",position:"relative",width:"169px",height:"36px",backgroundColor:"#4CAF50",color:"white",boxShadow:"0px 0px 6px 1px grey",borderRadius:"5px",lineHeight:"37px",fontSize:"11px",textAlign:"center",cursor:"pointer",marginTop:"14px"},j={fontSize:"13px",width:"340px",marginLeft:"18px",marginTop:"14px",lineHeight:"20px",color:"grey"},_="appBlock",V="appBlockTopMenu",J="appBlockTopMenuSpan",q="appBlockTopMenuSpanTwo",K=function(e){i(a,React.Component);var t=l(a);function a(e){var n;return o(this,a),(n=t.call(this,e)).state={targetElem:JSON.parse(localStorage.getItem("nodeData")),addedElems:0,goalsPack:[],goalName:"",counterName:"",startMessage:"выберите элемент, на который хотите поставить цель, нажав на него правой кнопкой мыши",popUpMessage:"no message no message no message no message",popUpShow:!1,addValidate:!1},n}return n(a,[{key:"componentDidMount",value:function(){var e=this;setInterval((function(){e.setState({targetElem:JSON.parse(localStorage.getItem("nodeData"))})}),100),setInterval((function(){"true"===localStorage.getItem("clearState")&&(e.setState({goalsPack:[],addedElems:0}),localStorage.setItem("clearState","false"))}),1e3)}},{key:"render",value:function(){var e=this;return React.createElement(React.Fragment,null,1==this.state.popUpShow?React.createElement("section",{style:C,onClick:function(){e.setState({popUpShow:!1,popUpMessage:"no message no message no message no message"})}},React.createElement("span",{style:L},this.state.popUpMessage)):null,React.createElement("div",{className:"appBlockMainGoalsWindow",style:R},"NULLNODE"==this.state.targetElem.tagname?React.createElement("p",{style:D},this.state.startMessage):null,React.createElement("span",{style:H,onClick:function(){0!=e.state.addedElems||e.setState({popUpShow:!0,popUpMessage:"Список триггеров пуст. Вы не создали ни одной цели. Выберите нужный элемент на сайте, заполните поле с ID цели и попробуйте снова"})}},this.state.addedElems,this.state.addedElems>0?React.createElement("span",{style:U}):null),"NULLNODE"!=this.state.targetElem.tagname?React.createElement(React.Fragment,null,React.createElement("div",{style:I},React.createElement("p",null,this.state.targetElem.tagname),React.createElement("p",null,this.state.targetElem.attr.map((function(e){if("style"!==e.split("::")[0])return React.createElement("p",null,"".concat(e.split("::")[0])," - ",React.createElement("span",null,"".concat(e.split("::")[1])))}))),React.createElement("input",{style:T,type:"text",placeholder:"Идентификатор цели*",maxlength:"13",onKeyUp:function(t){var o=t.target.value;e.setState({goalName:o}),o.length>4&&e.state.counterName.length>=6?e.setState({addValidate:!0}):e.setState({addValidate:!1})}}),React.createElement("span",{style:!1===this.state.addValidate?B:z,onClick:function(){if(e.state.goalName.length>4&&e.state.counterName.length>=6){var t=JSON.parse(localStorage.getItem("nodeData"));if("NULLNODE"!=t.tagname){var o=e.state.goalsPack,a=!0;o.forEach((function(t){"string"==typeof t&&t.split("**")[0]==e.state.goalName&&(a=!1,e.setState({popUpShow:!0,popUpMessage:"Цель с таким ID уже создана, введите другой ID. Идентификатор должен быть уникальным для корректного сбора статистики"}))})),1==a&&(o.push(t),o.push("".concat(e.state.goalName,"**").concat(e.state.counterName)),localStorage.setItem("nodeData",'{"attr":["class::appBlock"],"tagname":"NULLNODE"}'),e.setState({addedElems:e.state.addedElems+1,goalsPack:o,goalName:"",counterName:"",addValidate:!1}),e.props.goalsTransport(o),o=[])}}else e.setState({popUpShow:!0,popUpMessage:"Введите ID цели, длиной не менее 5 знаков. Идентификатор это уникальное имя цели в Метрике, по нему распределяются данные"})}},"ДОБАВИТЬ")),React.createElement("div",null,React.createElement("input",{style:N,type:"text",placeholder:"Номер счетчика*",maxlength:"10",onKeyUp:function(t){var o=t.target.value;e.setState({counterName:o}),o.length>=6&&e.state.goalName.length>4?e.setState({addValidate:!0}):e.setState({addValidate:!1})}}))):null))}}]),a}(),W=function(e){i(r,React.Component);var a=l(r);function r(e){var t;return o(this,r),(t=a.call(this,e)).state={goalsPackParent:[],publicPack:"",showGoal1:!1,showGoal2:!1,showGoal3:!1,showGoal4:!1,showGoal5:!1,showGoal6:!1,showGoal7:!1,showGoal8:!1,showGoal9:!1,showGoal10:!1,login:"",password:"",authButton:!1,authShow:!1,authCorrect:!1,popUpShow:!1,popUpMessage:"no message no message no message no message",publicButtonInner:"ОПУБЛИКОВАТЬ",exportHashLine:"",goalsCodeComment:!1,authColor:!0},t.setGoalsState=t.setGoalsState.bind(s(t)),t.testFunc=t.testFunc.bind(s(t)),t}return n(r,[{key:"testFunc",value:function(){this.setState({showGoal1:!this.state.showGoal1})}},{key:"componentWillMount",value:function(){localStorage.setItem("cstr","ready"),localStorage.removeItem("nodeData"),null==localStorage.getItem("nodeData")&&localStorage.setItem("nodeData",'{"attr":["class::appBlock"],"tagname":"NULLNODE"}')}},{key:"componentDidMount",value:function(){localStorage.setItem("exportGoalData",""),localStorage.setItem("clearState","false")}},{key:"setGoalsState",value:function(e){console.log(e),this.setState({goalsPackParent:e})}},{key:"render",value:function(){var e=this;return React.createElement(React.Fragment,null,React.createElement("section",{className:_,style:g},React.createElement("div",{className:V,style:b},React.createElement("span",{style:f}),"celestaver",React.createElement("span",{className:J,style:S}),React.createElement("span",{className:q,style:w})),React.createElement(K,{goalsTransport:this.setGoalsState})),React.createElement("section",{className:_,style:h},React.createElement("div",{className:V,style:y},"созданные цели",React.createElement("i",{style:{marginLeft:"16px",fontWeight:"bold",cursor:"pointer"},onClick:this.testFunc},"подробно"),React.createElement("span",{className:J,style:S}),React.createElement("span",{className:q,style:w})),React.createElement("div",{style:k},!0===this.state.goalsCodeComment?React.createElement(React.Fragment,null,React.createElement("code",{style:E,id:"goalcode"},'<script type="text/javascript" src="http://cq52508.tmweb.ru/celestaver/goals.js"/>\n               <script>localStorage.setItem(\'cstrhash\', \''.concat(this.state.exportHashLine,"');let roundLocal=setInterval(()=>{let ls=localStorage.getItem('cstrhash');\n               if(ls!==null&&ls!==''){fetch(\"http://cq52508.tmweb.ru/celestaver/get.php?data=\"+localStorage.getItem('cstrhash')).then(res => res.text()).then(data=>{let newData=JSON.parse(data);cstrGoalsMaker(newData);}); \n               clearInterval(roundLocal);}else{console.log('Вы не авторизованы');clearInterval(roundLocal);}},1000);<\/script>")),React.createElement("p",{style:j},"Скопируйте этот код и разместите его на вашем сайте. Сделать это нужно один раз, при дальнейшей работе с сервисом просто публикуйте новые цели"),React.createElement("span",{style:M,onClick:function(){e.setState({goalsCodeComment:!1})}},"ПРОДОЛЖИТЬ РАБОТУ")):null,this.state.goalsPackParent.map((function(e,o){var a;return React.createElement("article",{style:v},(o+1)%2==0?React.createElement("p",{style:t({marginBottom:"0px",marginTop:"-2px",height:"36px",lineHeight:"34px",width:"160px",backgroundColor:"rgb(76, 175, 80, 0.3)",borderRadius:"20px",textAlign:"center",marginLeft:"14px"},"marginBottom","12px")},e.split("**")[0]):React.createElement("p",{style:(a={marginBottom:"0px",marginTop:"0px",height:"auto",lineHeight:"38px",paddingLeft:"12px"},t(a,"marginBottom","14px"),t(a,"borderTop","1px solid rgb(224, 224, 224)"),a)},React.createElement("span",{style:{height:"0px"}}),!0===this.state.showGoal1?React.createElement("article",{style:{display:"block",position:"relative",width:"100%",height:"auto",minHeight:"30px",fontStyle:"italic",marginLeft:"-12px",marginTop:"0.5px"}},React.createElement("p",{style:{width:"80%",height:"36px",lineHeight:"36px",backgroundColor:"rgb(76, 175, 80, 0.3)",paddingLeft:"12px","border-top-right-radius":"15px","border-bottom-right-radius":"15px"}},e.tagname),e.attr.map((function(e){return React.createElement("p",{style:{height:"32px",lineHeight:"30px",backgroundColor:"rgb(224, 224, 224)",margin:"0",paddingLeft:"14px","border-top-left-radius":"15px","border-bottom-left-radius":"15px",marginLeft:"14px",marginBottom:"12px"}},"".concat(e.split("::")[0]," - ").concat(e.split("::")[1]))})),void 0!==e.inner?React.createElement("p",{style:{height:"32px",lineHeight:"30px",backgroundColor:"rgb(224, 224, 224)",margin:"0",paddingLeft:"14px","border-top-left-radius":"15px","border-bottom-left-radius":"15px",marginLeft:"14px"}},"Иннер - ".concat(e.inner)):null):null))}),this)),React.createElement("div",{style:P},React.createElement("span",{style:!0===this.state.authColor?O:G,onClick:function(){var t=!1;localStorage.setItem("exportGoalData",JSON.stringify(e.state.goalsPackParent)),null==localStorage.getItem("cstrhash")||""==localStorage.getItem("cstrhash")?e.setState({authButton:!0,publicButtonInner:"AUTH ERROR",authColor:!1}):(t=!0,fetch("http://cq52508.tmweb.ru/celestaver/add.php?data=".concat(localStorage.getItem("cstrhash"),"AND").concat(JSON.stringify(e.state.goalsPackParent))).then((function(e){return e.text()})).then((function(e){})),e.setState({exportHashLine:localStorage.getItem("cstrhash"),goalsCodeComment:!0,goalsPackParent:[]}),localStorage.setItem("clearState","true")),!0===t&&setTimeout((function(){e.setState({goalsPackParent:[]})}),200)}},this.state.publicButtonInner),!0===this.state.authButton?React.createElement("span",{style:O,onClick:function(){e.setState({authShow:!0})}},"МОЙ ЛОГИН"):null)),!0===this.state.authShow?React.createElement("section",{className:_,style:u},!0===this.state.popUpShow?React.createElement("section",{style:C,onClick:function(){e.setState({popUpShow:!1,popUpMessage:"no message no message no message no message"})}},React.createElement("span",{style:L},this.state.popUpMessage)):null,React.createElement("div",{className:V,style:y},"работа с учетной записью"),!1===this.state.authCorrect?React.createElement(React.Fragment,null,React.createElement("div",{style:x},React.createElement("input",{style:m,type:"text",placeholder:"create or write login*",onKeyUp:function(t){e.setState({login:t.target.value})}}),React.createElement("input",{style:m,type:"text",placeholder:"create or write password*",onKeyUp:function(t){e.setState({password:t.target.value})}}),React.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",marginTop:"17px"}},React.createElement("input",{style:{display:"block",width:"16px",height:"16px",borderRadius:"50%",cursor:"pointer"},type:"checkbox",checked:"false"}),React.createElement("span",{style:{display:"block",fontSize:"13px",marginTop:"1px",marginLeft:"4px",textDecoration:"underline",cursor:"pointer"}},"Пользовательское соглашение")),React.createElement("span",{style:A,onClick:function(){if(""!==e.state.login&&""!==e.state.password){var t="".concat(e.state.login,"::").concat(e.state.password);fetch("http://cq52508.tmweb.ru/celestaver/index.php?data=".concat(t)).then((function(e){return e.text()})).then((function(t){if(-1!==t.indexOf("true")){e.setState({authShow:!1,authButton:!1,publicButtonInner:"ОПУБЛИКОВАТЬ",authColor:!0});var o=t.split(".")[1];localStorage.setItem("cstrhash",o)}}))}else e.setState({popUpShow:!0,popUpMessage:"Не все поля формы регистрации заполнены. Проверьте оба поля, они должны быть заполнены в соответствии с правилами"})}},"ЗАРЕГИСТРИРОВАТЬСЯ"),React.createElement("span",{style:F,onClick:function(){""!==e.state.login&&""!==e.state.password&&fetch("http://cq52508.tmweb.ru/celestaver/auth.php?data=".concat(e.state.login,"$$").concat(e.state.password)).then((function(e){return e.text()})).then((function(t){console.log(t),"Неверные логин или пароль"!==t&&(localStorage.setItem("cstrhash",t),e.setState({authShow:!1,authButton:!1,publicButtonInner:"ОПУБЛИКОВАТЬ",authColor:!0}))}))}},"АВТОРИЗОВАТЬСЯ"))):null):null)}}]),r}();ReactDOM.render(React.createElement(W,null),document.getElementById("cstr"))})();